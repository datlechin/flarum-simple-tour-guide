/*! For license information please see forum.js.LICENSE.txt */
(()=>{var t={648:(t,e,o)=>{var n=o(288).default;function r(){"use strict";t.exports=r=function(){return o},t.exports.__esModule=!0,t.exports.default=t.exports;var e,o={},i=Object.prototype,s=i.hasOwnProperty,a=Object.defineProperty||function(t,e,o){t[e]=o.value},l="function"==typeof Symbol?Symbol:{},c=l.iterator||"@@iterator",d=l.asyncIterator||"@@asyncIterator",u=l.toStringTag||"@@toStringTag";function p(t,e,o){return Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{p({},"")}catch(e){p=function(t,e,o){return t[e]=o}}function v(t,e,o,n){var r=e&&e.prototype instanceof x?e:x,i=Object.create(r.prototype),s=new M(n||[]);return a(i,"_invoke",{value:T(t,o,s)}),i}function h(t,e,o){try{return{type:"normal",arg:t.call(e,o)}}catch(t){return{type:"throw",arg:t}}}o.wrap=v;var f="suspendedStart",m="suspendedYield",g="executing",y="completed",w={};function x(){}function b(){}function _(){}var L={};p(L,c,(function(){return this}));var E=Object.getPrototypeOf,C=E&&E(E(D([])));C&&C!==i&&s.call(C,c)&&(L=C);var k=_.prototype=x.prototype=Object.create(L);function P(t){["next","throw","return"].forEach((function(e){p(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function o(r,i,a,l){var c=h(t[r],t,i);if("throw"!==c.type){var d=c.arg,u=d.value;return u&&"object"==n(u)&&s.call(u,"__await")?e.resolve(u.__await).then((function(t){o("next",t,a,l)}),(function(t){o("throw",t,a,l)})):e.resolve(u).then((function(t){d.value=t,a(d)}),(function(t){return o("throw",t,a,l)}))}l(c.arg)}var r;a(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,r){o(t,n,e,r)}))}return r=r?r.then(i,i):i()}})}function T(t,o,n){var r=f;return function(i,s){if(r===g)throw new Error("Generator is already running");if(r===y){if("throw"===i)throw s;return{value:e,done:!0}}for(n.method=i,n.arg=s;;){var a=n.delegate;if(a){var l=B(a,n);if(l){if(l===w)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=g;var c=h(t,o,n);if("normal"===c.type){if(r=n.done?y:m,c.arg===w)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=y,n.method="throw",n.arg=c.arg)}}}function B(t,o){var n=o.method,r=t.iterator[n];if(r===e)return o.delegate=null,"throw"===n&&t.iterator.return&&(o.method="return",o.arg=e,B(t,o),"throw"===o.method)||"return"!==n&&(o.method="throw",o.arg=new TypeError("The iterator does not provide a '"+n+"' method")),w;var i=h(r,t.iterator,o.arg);if("throw"===i.type)return o.method="throw",o.arg=i.arg,o.delegate=null,w;var s=i.arg;return s?s.done?(o[t.resultName]=s.value,o.next=t.nextLoc,"return"!==o.method&&(o.method="next",o.arg=e),o.delegate=null,w):s:(o.method="throw",o.arg=new TypeError("iterator result is not an object"),o.delegate=null,w)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function $(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function D(t){if(t||""===t){var o=t[c];if(o)return o.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function o(){for(;++r<t.length;)if(s.call(t,r))return o.value=t[r],o.done=!1,o;return o.value=e,o.done=!0,o};return i.next=i}}throw new TypeError(n(t)+" is not iterable")}return b.prototype=_,a(k,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:b,configurable:!0}),b.displayName=p(_,u,"GeneratorFunction"),o.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,p(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},o.awrap=function(t){return{__await:t}},P(S.prototype),p(S.prototype,d,(function(){return this})),o.AsyncIterator=S,o.async=function(t,e,n,r,i){void 0===i&&(i=Promise);var s=new S(v(t,e,n,r),i);return o.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},P(k),p(k,u,"Generator"),p(k,c,(function(){return this})),p(k,"toString",(function(){return"[object Generator]"})),o.keys=function(t){var e=Object(t),o=[];for(var n in e)o.push(n);return o.reverse(),function t(){for(;o.length;){var n=o.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},o.values=D,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach($),!t)for(var o in this)"t"===o.charAt(0)&&s.call(this,o)&&!isNaN(+o.slice(1))&&(this[o]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var o=this;function n(n,r){return a.type="throw",a.arg=t,o.next=n,r&&(o.method="next",o.arg=e),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var l=s.call(i,"catchLoc"),c=s.call(i,"finallyLoc");if(l&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=t,i.arg=e,r?(this.method="next",this.next=r.finallyLoc,w):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),w},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),$(o),w}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc===t){var n=o.completion;if("throw"===n.type){var r=n.arg;$(o)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,o,n){return this.delegate={iterator:D(t),resultName:o,nextLoc:n},"next"===this.method&&(this.arg=e),w}},o}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},288:t=>{function e(o){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(o)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},357:(t,e,o)=>{var n=o(648)();t.exports=n;try{regeneratorRuntime=n}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}}},e={};function o(n){var r=e[n];if(void 0!==r)return r.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,o),i.exports}o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";o.r(n),o.d(n,{extend:()=>d});const t=flarum.core.compat["common/extenders"];var e=o.n(t);function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}const i=flarum.core.compat["common/Model"];var s=o.n(i),a=function(t){var e,o;function n(){return t.apply(this,arguments)||this}o=t,(e=n).prototype=Object.create(o.prototype),e.prototype.constructor=e,r(e,o);var i=n.prototype;return i.title=function(){return s().attribute("title").call(this)},i.description=function(){return s().attribute("description").call(this)},i.target=function(){return s().attribute("target").call(this)},i.isTriggerClick=function(){return s().attribute("isTriggerClick").call(this)},n}(s());const l=flarum.core.compat["common/models/User"];var c=o.n(l);const d=[new(e().Model)(c()).attribute("tourGuideDismissedAt").attribute("canResetTourGuide"),(new(e().Store)).add("tour-guide-steps",a)];function u(t,e,o,n,r,i,s){try{var a=t[i](s),l=a.value}catch(t){return void o(t)}a.done?e(l):Promise.resolve(l).then(n,r)}function p(t){return function(){var e=this,o=arguments;return new Promise((function(n,r){var i=t.apply(e,o);function s(t){u(i,n,r,s,a,"next",t)}function a(t){u(i,n,r,s,a,"throw",t)}s(void 0)}))}}var v=o(357),h=o.n(v);const f=flarum.core.compat["forum/app"];var g=o.n(f);let y={};function w(t={}){y={animate:!0,allowClose:!0,overlayOpacity:.7,smoothScroll:!1,disableActiveInteraction:!1,showProgress:!1,stagePadding:10,stageRadius:5,popoverOffset:10,showButtons:["next","previous","close"],disableButtons:[],overlayColor:"#000",...t}}function x(t){return t?y[t]:y}function b(t,e,o,n){return(t/=n/2)<1?o/2*t*t+e:-o/2*(--t*(t-2)-1)+e}function _(t){const e='a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled])';return t.flatMap((t=>{const o=t.matches(e),n=Array.from(t.querySelectorAll(e));return[...o?[t]:[],...n]})).filter((t=>"none"!==getComputedStyle(t).pointerEvents&&function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)}(t)))}function L(t){if(!t||function(t){const e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}(t))return;const e=x("smoothScroll");t.scrollIntoView({behavior:!e||E(t)?"auto":"smooth",inline:"center",block:"center"})}function E(t){if(!t||!t.parentElement)return;const e=t.parentElement;return e.scrollHeight>e.clientHeight}let C={};function k(t,e){C[t]=e}function P(t){return t?C[t]:C}function S(){C={}}let T={};function B(t,e){T[t]=e}function A(t){var e;null==(e=T[t])||e.call(T)}function $(t){if(!t)return;const e=t.getBoundingClientRect(),o={x:e.x,y:e.y,width:e.width,height:e.height};k("__activeStagePosition",o),M(o)}function M(t){const e=P("__overlaySvg");if(!e)return void function(t){const e=function(t){const e=window.innerWidth,o=window.innerHeight,n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.classList.add("driver-overlay","driver-overlay-animated"),n.setAttribute("viewBox",`0 0 ${e} ${o}`),n.setAttribute("xmlSpace","preserve"),n.setAttribute("xmlnsXlink","http://www.w3.org/1999/xlink"),n.setAttribute("version","1.1"),n.setAttribute("preserveAspectRatio","xMinYMin slice"),n.style.fillRule="evenodd",n.style.clipRule="evenodd",n.style.strokeLinejoin="round",n.style.strokeMiterlimit="2",n.style.zIndex="10000",n.style.position="fixed",n.style.top="0",n.style.left="0",n.style.width="100%",n.style.height="100%";const r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",D(t)),r.style.fill=x("overlayColor")||"rgb(0,0,0)",r.style.opacity=`${x("overlayOpacity")}`,r.style.pointerEvents="auto",r.style.cursor="auto",n.appendChild(r),n}(t);document.body.appendChild(e),R(e,(t=>{"path"===t.target.tagName&&A("overlayClick")})),k("__overlaySvg",e)}(t);const o=e.firstElementChild;if("path"!==(null==o?void 0:o.tagName))throw new Error("no path element found in stage svg");o.setAttribute("d",D(t))}function D(t){const e=window.innerWidth,o=window.innerHeight,n=x("stagePadding")||0,r=x("stageRadius")||0,i=t.width+2*n,s=t.height+2*n,a=Math.min(r,i/2,s/2),l=Math.floor(Math.max(a,0)),c=i-2*l,d=s-2*l;return`M${e},0L0,0L0,${o}L${e},${o}L${e},0Z\n    M${t.x-n+l},${t.y-n} h${c} a${l},${l} 0 0 1 ${l},${l} v${d} a${l},${l} 0 0 1 -${l},${l} h-${c} a${l},${l} 0 0 1 -${l},-${l} v-${d} a${l},${l} 0 0 1 ${l},-${l} z`}function H(t){const{element:e}=t;let o="string"==typeof e?document.querySelector(e):e;o||(o=function(){const t=document.getElementById("driver-dummy-element");if(t)return t;let e=document.createElement("div");return e.id="driver-dummy-element",e.style.width="0",e.style.height="0",e.style.pointerEvents="none",e.style.opacity="0",e.style.position="fixed",e.style.top="50%",e.style.left="50%",document.body.appendChild(e),e}()),function(t,e){const o=Date.now(),n=P("__activeStep"),r=P("__activeElement")||t,i=!r||r===t,s="driver-dummy-element"===t.id,a="driver-dummy-element"===r.id,l=x("animate"),c=e.onHighlightStarted||x("onHighlightStarted"),d=(null==e?void 0:e.onHighlighted)||x("onHighlighted"),u=(null==n?void 0:n.onDeselected)||x("onDeselected"),p=x(),v=P();!i&&u&&u(a?void 0:r,n,{config:p,state:v}),c&&c(s?void 0:t,e,{config:p,state:v});const h=!i&&l;let f=!1;(function(){const t=P("popover");t&&(t.wrapper.style.display="none")})(),k("previousStep",n),k("previousElement",r),k("activeStep",e),k("activeElement",t);const m=()=>{if(P("__transitionCallback")!==m)return;const i=Date.now()-o,a=400-i<=200;e.popover&&a&&!f&&h&&(j(t,e),f=!0),x("animate")&&i<400?function(t,e,o,n){let r=P("__activeStagePosition");const i=r||o.getBoundingClientRect(),s=n.getBoundingClientRect();r={x:b(t,i.x,s.x-i.x,e),y:b(t,i.y,s.y-i.y,e),width:b(t,i.width,s.width-i.width,e),height:b(t,i.height,s.height-i.height,e)},M(r),k("__activeStagePosition",r)}(i,400,r,t):($(t),d&&d(s?void 0:t,e,{config:x(),state:P()}),k("__transitionCallback",void 0),k("__previousStep",n),k("__previousElement",r),k("__activeStep",e),k("__activeElement",t)),window.requestAnimationFrame(m)};k("__transitionCallback",m),window.requestAnimationFrame(m),L(t),!h&&e.popover&&j(t,e),r.classList.remove("driver-active-element","driver-no-interaction"),r.removeAttribute("aria-haspopup"),r.removeAttribute("aria-expanded"),r.removeAttribute("aria-controls"),x("disableActiveInteraction")&&t.classList.add("driver-no-interaction"),t.classList.add("driver-active-element"),t.setAttribute("aria-haspopup","dialog"),t.setAttribute("aria-expanded","true"),t.setAttribute("aria-controls","driver-popover-content")}(o,t)}function O(){const t=P("__activeElement"),e=P("__activeStep");t&&($(t),function(){const t=P("__activeStagePosition"),e=P("__overlaySvg");if(!t)return;if(!e)return void console.warn("No stage svg found.");const o=window.innerWidth,n=window.innerHeight;e.setAttribute("viewBox",`0 0 ${o} ${n}`)}(),q(t,e))}function N(){const t=P("__resizeTimeout");t&&window.cancelAnimationFrame(t),k("__resizeTimeout",window.requestAnimationFrame(O))}function I(t){var e;if(!P("isInitialized")||"Tab"!==t.key&&9!==t.keyCode)return;const o=P("__activeElement"),n=null==(e=P("popover"))?void 0:e.wrapper,r=_([...n?[n]:[],...o?[o]:[]]),i=r[0],s=r[r.length-1];if(t.preventDefault(),t.shiftKey){const t=r[r.indexOf(document.activeElement)-1]||s;null==t||t.focus()}else{const t=r[r.indexOf(document.activeElement)+1]||i;null==t||t.focus()}}function W(t){var e;(null==(e=x("allowKeyboardControl"))||e)&&("Escape"===t.key?A("escapePress"):"ArrowRight"===t.key?A("arrowRightPress"):"ArrowLeft"===t.key&&A("arrowLeftPress"))}function R(t,e,o){const n=(e,n)=>{const r=e.target;t.contains(r)&&((!o||o(r))&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()),null==n||n(e))};document.addEventListener("pointerdown",n,!0),document.addEventListener("mousedown",n,!0),document.addEventListener("pointerup",n,!0),document.addEventListener("mouseup",n,!0),document.addEventListener("click",(t=>{n(t,e)}),!0)}function j(t,e){var o,n;let r=P("popover");r&&document.body.removeChild(r.wrapper),r=function(){const t=document.createElement("div");t.classList.add("driver-popover");const e=document.createElement("div");e.classList.add("driver-popover-arrow");const o=document.createElement("header");o.id="driver-popover-title",o.classList.add("driver-popover-title"),o.style.display="none",o.innerText="Popover Title";const n=document.createElement("div");n.id="driver-popover-description",n.classList.add("driver-popover-description"),n.style.display="none",n.innerText="Popover description is here";const r=document.createElement("button");r.type="button",r.classList.add("driver-popover-close-btn"),r.setAttribute("aria-label","Close"),r.innerHTML="&times;";const i=document.createElement("footer");i.classList.add("driver-popover-footer");const s=document.createElement("span");s.classList.add("driver-popover-progress-text"),s.innerText="";const a=document.createElement("span");a.classList.add("driver-popover-navigation-btns");const l=document.createElement("button");l.type="button",l.classList.add("driver-popover-prev-btn"),l.innerHTML="&larr; Previous";const c=document.createElement("button");return c.type="button",c.classList.add("driver-popover-next-btn"),c.innerHTML="Next &rarr;",a.appendChild(l),a.appendChild(c),i.appendChild(s),i.appendChild(a),t.appendChild(r),t.appendChild(e),t.appendChild(o),t.appendChild(n),t.appendChild(i),{wrapper:t,arrow:e,title:o,description:n,footer:i,previousButton:l,nextButton:c,closeButton:r,footerButtons:a,progress:s}}(),document.body.appendChild(r.wrapper);const{title:i,description:s,showButtons:a,disableButtons:l,showProgress:c,nextBtnText:d=x("nextBtnText")||"Next &rarr;",prevBtnText:u=x("prevBtnText")||"&larr; Previous",progressText:p=x("progressText")||"{current} of {total}"}=e.popover||{};r.nextButton.innerHTML=d,r.previousButton.innerHTML=u,r.progress.innerHTML=p,i?(r.title.innerHTML=i,r.title.style.display="block"):r.title.style.display="none",s?(r.description.innerHTML=s,r.description.style.display="block"):r.description.style.display="none";const v=a||x("showButtons"),h=c||x("showProgress")||!1,f=(null==v?void 0:v.includes("next"))||(null==v?void 0:v.includes("previous"))||h;r.closeButton.style.display=v.includes("close")?"block":"none",f?(r.footer.style.display="flex",r.progress.style.display=h?"block":"none",r.nextButton.style.display=v.includes("next")?"block":"none",r.previousButton.style.display=v.includes("previous")?"block":"none"):r.footer.style.display="none";const m=l||x("disableButtons")||[];null!=m&&m.includes("next")&&(r.nextButton.disabled=!0,r.nextButton.classList.add("driver-popover-btn-disabled")),null!=m&&m.includes("previous")&&(r.previousButton.disabled=!0,r.previousButton.classList.add("driver-popover-btn-disabled")),null!=m&&m.includes("close")&&(r.closeButton.disabled=!0,r.closeButton.classList.add("driver-popover-btn-disabled"));const g=r.wrapper;g.style.display="block",g.style.left="",g.style.top="",g.style.bottom="",g.style.right="",g.id="driver-popover-content",g.setAttribute("role","dialog"),g.setAttribute("aria-labelledby","driver-popover-title"),g.setAttribute("aria-describedby","driver-popover-description"),r.arrow.className="driver-popover-arrow";const y=(null==(o=e.popover)?void 0:o.popoverClass)||x("popoverClass")||"";g.className=`driver-popover ${y}`.trim(),R(r.wrapper,(o=>{var n,r,i;const s=o.target,a=(null==(n=e.popover)?void 0:n.onNextClick)||x("onNextClick"),l=(null==(r=e.popover)?void 0:r.onPrevClick)||x("onPrevClick"),c=(null==(i=e.popover)?void 0:i.onCloseClick)||x("onCloseClick");return s.classList.contains("driver-popover-next-btn")?a?a(t,e,{config:x(),state:P()}):A("nextClick"):s.classList.contains("driver-popover-prev-btn")?l?l(t,e,{config:x(),state:P()}):A("prevClick"):s.classList.contains("driver-popover-close-btn")?c?c(t,e,{config:x(),state:P()}):A("closeClick"):void 0}),(t=>!(null!=r&&r.description.contains(t))&&!(null!=r&&r.title.contains(t))&&"string"==typeof t.className&&t.className.includes("driver-popover"))),k("popover",r);const w=(null==(n=e.popover)?void 0:n.onPopoverRender)||x("onPopoverRender");w&&w(r,{config:x(),state:P()}),q(t,e),L(g);const b=_([g,...t.classList.contains("driver-dummy-element")?[]:[t]]);b.length>0&&b[0].focus()}function G(){const t=P("popover");if(null==t||!t.wrapper)return;const e=t.wrapper.getBoundingClientRect(),o=x("stagePadding")||0,n=x("popoverOffset")||0;return{width:e.width+o+n,height:e.height+o+n,realWidth:e.width,realHeight:e.height}}function z(t,e){const{elementDimensions:o,popoverDimensions:n,popoverPadding:r,popoverArrowDimensions:i}=e;return"start"===t?Math.max(Math.min(o.top-r,window.innerHeight-n.realHeight-i.width),i.width):"end"===t?Math.max(Math.min(o.top-(null==n?void 0:n.realHeight)+o.height+r,window.innerHeight-(null==n?void 0:n.realHeight)-i.width),i.width):"center"===t?Math.max(Math.min(o.top+o.height/2-(null==n?void 0:n.realHeight)/2,window.innerHeight-(null==n?void 0:n.realHeight)-i.width),i.width):0}function F(t,e){const{elementDimensions:o,popoverDimensions:n,popoverPadding:r,popoverArrowDimensions:i}=e;return"start"===t?Math.max(Math.min(o.left-r,window.innerWidth-n.realWidth-i.width),i.width):"end"===t?Math.max(Math.min(o.left-(null==n?void 0:n.realWidth)+o.width+r,window.innerWidth-(null==n?void 0:n.realWidth)-i.width),i.width):"center"===t?Math.max(Math.min(o.left+o.width/2-(null==n?void 0:n.realWidth)/2,window.innerWidth-(null==n?void 0:n.realWidth)-i.width),i.width):0}function q(t,e){const o=P("popover");if(!o)return;const{align:n="start",side:r="left"}=(null==e?void 0:e.popover)||{},i=n,s="driver-dummy-element"===t.id?"over":r,a=x("stagePadding")||0,l=G(),c=o.arrow.getBoundingClientRect(),d=t.getBoundingClientRect(),u=d.top-l.height;let p=u>=0;const v=window.innerHeight-(d.bottom+l.height);let h=v>=0;const f=d.left-l.width;let m=f>=0;const g=window.innerWidth-(d.right+l.width);let y=g>=0;const w=!(p||h||m||y);let b=s;if("top"===s&&p?y=m=h=!1:"bottom"===s&&h?y=m=p=!1:"left"===s&&m?y=p=h=!1:"right"===s&&y&&(m=p=h=!1),"over"===s){const t=window.innerWidth/2-l.realWidth/2,e=window.innerHeight/2-l.realHeight/2;o.wrapper.style.left=`${t}px`,o.wrapper.style.right="auto",o.wrapper.style.top=`${e}px`,o.wrapper.style.bottom="auto"}else if(w){const t=window.innerWidth/2-(null==l?void 0:l.realWidth)/2,e=10;o.wrapper.style.left=`${t}px`,o.wrapper.style.right="auto",o.wrapper.style.bottom=`${e}px`,o.wrapper.style.top="auto"}else if(m){const t=Math.min(f,window.innerWidth-(null==l?void 0:l.realWidth)-c.width),e=z(i,{elementDimensions:d,popoverDimensions:l,popoverPadding:a,popoverArrowDimensions:c});o.wrapper.style.left=`${t}px`,o.wrapper.style.top=`${e}px`,o.wrapper.style.bottom="auto",o.wrapper.style.right="auto",b="left"}else if(y){const t=Math.min(g,window.innerWidth-(null==l?void 0:l.realWidth)-c.width),e=z(i,{elementDimensions:d,popoverDimensions:l,popoverPadding:a,popoverArrowDimensions:c});o.wrapper.style.right=`${t}px`,o.wrapper.style.top=`${e}px`,o.wrapper.style.bottom="auto",o.wrapper.style.left="auto",b="right"}else if(p){const t=Math.min(u,window.innerHeight-l.realHeight-c.width);let e=F(i,{elementDimensions:d,popoverDimensions:l,popoverPadding:a,popoverArrowDimensions:c});o.wrapper.style.top=`${t}px`,o.wrapper.style.left=`${e}px`,o.wrapper.style.bottom="auto",o.wrapper.style.right="auto",b="top"}else if(h){const t=Math.min(v,window.innerHeight-(null==l?void 0:l.realHeight)-c.width);let e=F(i,{elementDimensions:d,popoverDimensions:l,popoverPadding:a,popoverArrowDimensions:c});o.wrapper.style.left=`${e}px`,o.wrapper.style.bottom=`${t}px`,o.wrapper.style.top="auto",o.wrapper.style.right="auto",b="bottom"}w?o.arrow.classList.add("driver-popover-arrow-none"):function(t,e,o){const n=P("popover");if(!n)return;const r=o.getBoundingClientRect(),i=G(),s=n.arrow,a=i.width,l=window.innerWidth,c=r.width,d=r.left,u=i.height,p=window.innerHeight,v=r.top,h=r.height;s.className="driver-popover-arrow";let f=e,m=t;"top"===e?(d+c<=0?(f="right",m="end"):d+c-a<=0&&(f="top",m="start"),d>=l?(f="left",m="end"):d+a>=l&&(f="top",m="end")):"bottom"===e?(d+c<=0?(f="right",m="start"):d+c-a<=0&&(f="bottom",m="start"),d>=l?(f="left",m="start"):d+a>=l&&(f="bottom",m="end")):"left"===e?(v+h<=0?(f="bottom",m="end"):v+h-u<=0&&(f="left",m="start"),v>=p?(f="top",m="end"):v+u>=p&&(f="left",m="end")):"right"===e&&(v+h<=0?(f="bottom",m="start"):v+h-u<=0&&(f="right",m="start"),v>=p?(f="top",m="start"):v+u>=p&&(f="right",m="end")),f?(s.classList.add(`driver-popover-arrow-side-${f}`),s.classList.add(`driver-popover-arrow-align-${m}`)):s.classList.add("driver-popover-arrow-none")}(i,b,t)}function U(t={}){function e(){x("allowClose")&&l()}function o(){const t=P("activeIndex"),e=x("steps")||[];if(void 0===t)return;const o=t+1;e[o]?a(o):l()}function n(){const t=P("activeIndex"),e=x("steps")||[];if(void 0===t)return;const o=t-1;e[o]?a(o):l()}function r(){var t;if(P("__transitionCallback"))return;const e=P("activeIndex"),o=P("__activeStep"),r=P("__activeElement");if(void 0===e||void 0===o||void 0===P("activeIndex"))return;const i=(null==(t=o.popover)?void 0:t.onPrevClick)||x("onPrevClick");if(i)return i(r,o,{config:x(),state:P()});n()}function i(){var t;if(P("__transitionCallback"))return;const e=P("activeIndex"),n=P("__activeStep"),r=P("__activeElement");if(void 0===e||void 0===n)return;const i=(null==(t=n.popover)?void 0:t.onNextClick)||x("onNextClick");if(i)return i(r,n,{config:x(),state:P()});o()}function s(){P("isInitialized")||(k("isInitialized",!0),document.body.classList.add("driver-active",x("animate")?"driver-fade":"driver-simple"),window.addEventListener("keyup",W,!1),window.addEventListener("keydown",I,!1),window.addEventListener("resize",N),window.addEventListener("scroll",N),B("overlayClick",e),B("escapePress",e),B("arrowLeftPress",r),B("arrowRightPress",i))}function a(t=0){var e,o,n,r,i,s,c,d;const u=x("steps");if(!u)return console.error("No steps to drive through"),void l();if(!u[t])return void l();k("__activeOnDestroyed",document.activeElement),k("activeIndex",t);const p=u[t],v=u[t+1],h=u[t-1],f=(null==(e=p.popover)?void 0:e.doneBtnText)||x("doneBtnText")||"Done",m=x("allowClose"),g=void 0!==(null==(o=p.popover)?void 0:o.showProgress)?null==(n=p.popover)?void 0:n.showProgress:x("showProgress"),y=((null==(r=p.popover)?void 0:r.progressText)||x("progressText")||"{{current}} of {{total}}").replace("{{current}}",`${t+1}`).replace("{{total}}",`${u.length}`),w=(null==(i=p.popover)?void 0:i.showButtons)||x("showButtons"),b=["next","previous",...m?["close"]:[]].filter((t=>!(null!=w&&w.length)||w.includes(t))),_=(null==(s=p.popover)?void 0:s.onNextClick)||x("onNextClick"),L=(null==(c=p.popover)?void 0:c.onPrevClick)||x("onPrevClick"),E=(null==(d=p.popover)?void 0:d.onCloseClick)||x("onCloseClick");H({...p,popover:{showButtons:b,nextBtnText:v?void 0:f,disableButtons:[...h?[]:["previous"]],showProgress:g,progressText:y,onNextClick:_||(()=>{v?a(t+1):l()}),onPrevClick:L||(()=>{a(t-1)}),onCloseClick:E||(()=>{l()}),...(null==p?void 0:p.popover)||{}}})}function l(t=!0){const e=P("__activeElement"),o=P("__activeStep"),n=P("__activeOnDestroyed"),r=x("onDestroyStarted");if(t&&r)return void r(e&&"driver-dummy-element"!==(null==e?void 0:e.id)?e:void 0,o,{config:x(),state:P()});const i=(null==o?void 0:o.onDeselected)||x("onDeselected"),s=x("onDestroyed");if(document.body.classList.remove("driver-active","driver-fade","driver-simple"),window.removeEventListener("keyup",W),window.removeEventListener("resize",N),window.removeEventListener("scroll",N),function(){var t;const e=P("popover");e&&(null==(t=e.wrapper.parentElement)||t.removeChild(e.wrapper))}(),function(){var t;null==(t=document.getElementById("driver-dummy-element"))||t.remove(),document.querySelectorAll(".driver-active-element").forEach((t=>{t.classList.remove("driver-active-element","driver-no-interaction"),t.removeAttribute("aria-haspopup"),t.removeAttribute("aria-expanded"),t.removeAttribute("aria-controls")}))}(),function(){const t=P("__overlaySvg");t&&t.remove()}(),T={},S(),e&&o){const t="driver-dummy-element"===e.id;i&&i(t?void 0:e,o,{config:x(),state:P()}),s&&s(t?void 0:e,o,{config:x(),state:P()})}n&&n.focus()}return w(t),{isActive:()=>P("isInitialized")||!1,refresh:N,drive:(t=0)=>{s(),a(t)},setConfig:w,setSteps:t=>{S(),w({...x(),steps:t})},getConfig:x,getState:P,getActiveIndex:()=>P("activeIndex"),isFirstStep:()=>0===P("activeIndex"),isLastStep:()=>{const t=x("steps")||[],e=P("activeIndex");return void 0!==e&&e===t.length-1},getActiveStep:()=>P("activeStep"),getActiveElement:()=>P("activeElement"),getPreviousElement:()=>P("previousElement"),getPreviousStep:()=>P("previousStep"),moveNext:o,movePrevious:n,moveTo:function(t){(x("steps")||[])[t]?a(t):l()},hasNextStep:()=>{const t=x("steps")||[],e=P("activeIndex");return void 0!==e&&t[e+1]},hasPreviousStep:()=>{const t=x("steps")||[],e=P("activeIndex");return void 0!==e&&t[e-1]},highlight:t=>{s(),H({...t,popover:t.popover?{showButtons:[],showProgress:!1,progressText:"",...t.popover}:void 0})},destroy:()=>{l(!1)}}}const Y=flarum.core.compat["common/utils/extractText"];var K=o.n(Y);const V=flarum.core.compat["common/extend"],X=flarum.core.compat["forum/utils/UserControls"];var Z=o.n(X);const J=flarum.core.compat["common/components/Button"];var Q=o.n(J);g().initializers.add("datlechin/flarum-simple-tour-guide",(function(){(0,V.extend)(Z(),"userControls",(function(t,e){g().session.user.canResetTourGuide()&&e.attribute("tourGuideDismissedAt")&&t.add("reset-tour-guide",m(Q(),{icon:"fas fa-sync",onclick:function(){return function(t){confirm(K()(g().translator.trans("datlechin-simple-tour-guide.forum.user_controls.reset_tour_guide_confirmation")))&&t.save({tourGuideDismissedAt:null}).then((function(){return m.redraw()}))}(e)}},g().translator.trans("datlechin-simple-tour-guide.forum.user_controls.reset_tour_guide")))})),document.addEventListener("DOMContentLoaded",p(h().mark((function t(){var e,o,n,r,i,s,a;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=g().session.user)&&!e.tourGuideDismissedAt()){t.next=3;break}return t.abrupt("return");case 3:return o=[],t.next=6,g().store.find("tour-guide-steps").then((function(t){o=t}));case 6:n=function(){g().request({url:g().forum.attribute("apiUrl")+"/simple-tour-guide/dismiss",method:"POST"})},r=function(t,e){return void 0===e&&(e={}),K()(g().translator.trans("datlechin-simple-tour-guide.forum."+t,e))},s=function(){return o.map((function(t){return{element:t.target(),popover:{title:t.title(),description:t.description()},onDeselected:function(e){t.isTriggerClick()&&e.click()}}}))},(a=U({showProgress:(i=function(t){return g().forum.attribute("datlechin-simple-tour-guide."+t)})("showProgress"),allowClose:i("allowClose"),smoothScroll:!0,overlayColor:"var(--overlay-bg)",progressText:r("progress_text",{current:"{{current}}",total:"{{total}}"}),showButtons:i("skipNullElements")?["next"]:["next","previous"],nextBtnText:r("next_btn_text"),prevBtnText:r("prev_btn_text"),doneBtnText:r("done_btn_text"),steps:s(),onDestroyed:function(){n()},onHighlightStarted:function(t){!t&&i("skipNullElements")&&setTimeout((function(){return a.moveNext()}),10)}})).drive();case 12:case"end":return t.stop()}}),t)}))))}))})(),module.exports=n})();
//# sourceMappingURL=forum.js.map