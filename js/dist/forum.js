/*! For license information please see forum.js.LICENSE.txt */
(()=>{var t={648:(t,e,o)=>{var r=o(288).default;function n(){"use strict";t.exports=n=function(){return o},t.exports.__esModule=!0,t.exports.default=t.exports;var e,o={},i=Object.prototype,s=i.hasOwnProperty,a=Object.defineProperty||function(t,e,o){t[e]=o.value},l="function"==typeof Symbol?Symbol:{},c=l.iterator||"@@iterator",d=l.asyncIterator||"@@asyncIterator",u=l.toStringTag||"@@toStringTag";function p(t,e,o){return Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{p({},"")}catch(e){p=function(t,e,o){return t[e]=o}}function v(t,e,o,r){var n=e&&e.prototype instanceof x?e:x,i=Object.create(n.prototype),s=new M(r||[]);return a(i,"_invoke",{value:B(t,o,s)}),i}function h(t,e,o){try{return{type:"normal",arg:t.call(e,o)}}catch(t){return{type:"throw",arg:t}}}o.wrap=v;var f="suspendedStart",m="suspendedYield",g="executing",y="completed",w={};function x(){}function b(){}function _(){}var L={};p(L,c,(function(){return this}));var C=Object.getPrototypeOf,E=C&&C(C(D([])));E&&E!==i&&s.call(E,c)&&(L=E);var k=_.prototype=x.prototype=Object.create(L);function P(t){["next","throw","return"].forEach((function(e){p(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function o(n,i,a,l){var c=h(t[n],t,i);if("throw"!==c.type){var d=c.arg,u=d.value;return u&&"object"==r(u)&&s.call(u,"__await")?e.resolve(u.__await).then((function(t){o("next",t,a,l)}),(function(t){o("throw",t,a,l)})):e.resolve(u).then((function(t){d.value=t,a(d)}),(function(t){return o("throw",t,a,l)}))}l(c.arg)}var n;a(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,n){o(t,r,e,n)}))}return n=n?n.then(i,i):i()}})}function B(t,o,r){var n=f;return function(i,s){if(n===g)throw new Error("Generator is already running");if(n===y){if("throw"===i)throw s;return{value:e,done:!0}}for(r.method=i,r.arg=s;;){var a=r.delegate;if(a){var l=T(a,r);if(l){if(l===w)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=g;var c=h(t,o,r);if("normal"===c.type){if(n=r.done?y:m,c.arg===w)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=y,r.method="throw",r.arg=c.arg)}}}function T(t,o){var r=o.method,n=t.iterator[r];if(n===e)return o.delegate=null,"throw"===r&&t.iterator.return&&(o.method="return",o.arg=e,T(t,o),"throw"===o.method)||"return"!==r&&(o.method="throw",o.arg=new TypeError("The iterator does not provide a '"+r+"' method")),w;var i=h(n,t.iterator,o.arg);if("throw"===i.type)return o.method="throw",o.arg=i.arg,o.delegate=null,w;var s=i.arg;return s?s.done?(o[t.resultName]=s.value,o.next=t.nextLoc,"return"!==o.method&&(o.method="next",o.arg=e),o.delegate=null,w):s:(o.method="throw",o.arg=new TypeError("iterator result is not an object"),o.delegate=null,w)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function $(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function D(t){if(t||""===t){var o=t[c];if(o)return o.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function o(){for(;++n<t.length;)if(s.call(t,n))return o.value=t[n],o.done=!1,o;return o.value=e,o.done=!0,o};return i.next=i}}throw new TypeError(r(t)+" is not iterable")}return b.prototype=_,a(k,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:b,configurable:!0}),b.displayName=p(_,u,"GeneratorFunction"),o.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,p(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},o.awrap=function(t){return{__await:t}},P(S.prototype),p(S.prototype,d,(function(){return this})),o.AsyncIterator=S,o.async=function(t,e,r,n,i){void 0===i&&(i=Promise);var s=new S(v(t,e,r,n),i);return o.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},P(k),p(k,u,"Generator"),p(k,c,(function(){return this})),p(k,"toString",(function(){return"[object Generator]"})),o.keys=function(t){var e=Object(t),o=[];for(var r in e)o.push(r);return o.reverse(),function t(){for(;o.length;){var r=o.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},o.values=D,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach($),!t)for(var o in this)"t"===o.charAt(0)&&s.call(this,o)&&!isNaN(+o.slice(1))&&(this[o]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var o=this;function r(r,n){return a.type="throw",a.arg=t,o.next=r,n&&(o.method="next",o.arg=e),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var l=s.call(i,"catchLoc"),c=s.call(i,"finallyLoc");if(l&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o];if(r.tryLoc<=this.prev&&s.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var n=r;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var i=n?n.completion:{};return i.type=t,i.arg=e,n?(this.method="next",this.next=n.finallyLoc,w):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),w},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),$(o),w}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc===t){var r=o.completion;if("throw"===r.type){var n=r.arg;$(o)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,o,r){return this.delegate={iterator:D(t),resultName:o,nextLoc:r},"next"===this.method&&(this.arg=e),w}},o}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},288:t=>{function e(o){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(o)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},357:(t,e,o)=>{var r=o(648)();t.exports=r;try{regeneratorRuntime=r}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}}},e={};function o(r){var n=e[r];if(void 0!==n)return n.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,o),i.exports}o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{"use strict";o.r(r),o.d(r,{extend:()=>d});const t=flarum.core.compat["common/extenders"];var e=o.n(t);function n(t,e){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},n(t,e)}const i=flarum.core.compat["common/Model"];var s=o.n(i),a=function(t){var e,o;function r(){return t.apply(this,arguments)||this}o=t,(e=r).prototype=Object.create(o.prototype),e.prototype.constructor=e,n(e,o);var i=r.prototype;return i.title=function(){return s().attribute("title").call(this)},i.description=function(){return s().attribute("description").call(this)},i.target=function(){return s().attribute("target").call(this)},i.isTriggerClick=function(){return s().attribute("isTriggerClick").call(this)},r}(s());const l=flarum.core.compat["common/models/User"];var c=o.n(l);const d=[new(e().Model)(c()).attribute("tourGuideDismissedAt").attribute("canResetTourGuide"),(new(e().Store)).add("tour-guide-steps",a)];function u(t,e,o,r,n,i,s){try{var a=t[i](s),l=a.value}catch(t){return void o(t)}a.done?e(l):Promise.resolve(l).then(r,n)}function p(t){return function(){var e=this,o=arguments;return new Promise((function(r,n){var i=t.apply(e,o);function s(t){u(i,r,n,s,a,"next",t)}function a(t){u(i,r,n,s,a,"throw",t)}s(void 0)}))}}var v=o(357),h=o.n(v);const f=flarum.core.compat["forum/app"];var g=o.n(f);let y={};function w(t={}){y={animate:!0,allowClose:!0,overlayOpacity:.7,smoothScroll:!1,disableActiveInteraction:!1,showProgress:!1,stagePadding:10,stageRadius:5,popoverOffset:10,showButtons:["next","previous","close"],disableButtons:[],overlayColor:"#000",...t}}function x(t){return t?y[t]:y}function b(t,e,o,r){return(t/=r/2)<1?o/2*t*t+e:-o/2*(--t*(t-2)-1)+e}function _(t){const e='a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled])';return t.flatMap((t=>{const o=t.matches(e),r=Array.from(t.querySelectorAll(e));return[...o?[t]:[],...r]})).filter((t=>"none"!==getComputedStyle(t).pointerEvents&&function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)}(t)))}function L(t){if(!t||function(t){const e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}(t))return;const e=x("smoothScroll");t.scrollIntoView({behavior:!e||C(t)?"auto":"smooth",inline:"center",block:"center"})}function C(t){if(!t||!t.parentElement)return;const e=t.parentElement;return e.scrollHeight>e.clientHeight}let E={};function k(t,e){E[t]=e}function P(t){return t?E[t]:E}function S(){E={}}let B={};function T(t,e){B[t]=e}function A(t){var e;null==(e=B[t])||e.call(B)}function $(t){if(!t)return;const e=t.getBoundingClientRect(),o={x:e.x,y:e.y,width:e.width,height:e.height};k("__activeStagePosition",o),M(o)}function M(t){const e=P("__overlaySvg");if(!e)return void function(t){const e=function(t){const e=window.innerWidth,o=window.innerHeight,r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.classList.add("driver-overlay","driver-overlay-animated"),r.setAttribute("viewBox",`0 0 ${e} ${o}`),r.setAttribute("xmlSpace","preserve"),r.setAttribute("xmlnsXlink","http://www.w3.org/1999/xlink"),r.setAttribute("version","1.1"),r.setAttribute("preserveAspectRatio","xMinYMin slice"),r.style.fillRule="evenodd",r.style.clipRule="evenodd",r.style.strokeLinejoin="round",r.style.strokeMiterlimit="2",r.style.zIndex="10000",r.style.position="fixed",r.style.top="0",r.style.left="0",r.style.width="100%",r.style.height="100%";const n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",D(t)),n.style.fill=x("overlayColor")||"rgb(0,0,0)",n.style.opacity=`${x("overlayOpacity")}`,n.style.pointerEvents="auto",n.style.cursor="auto",r.appendChild(n),r}(t);document.body.appendChild(e),R(e,(t=>{"path"===t.target.tagName&&A("overlayClick")})),k("__overlaySvg",e)}(t);const o=e.firstElementChild;if("path"!==(null==o?void 0:o.tagName))throw new Error("no path element found in stage svg");o.setAttribute("d",D(t))}function D(t){const e=window.innerWidth,o=window.innerHeight,r=x("stagePadding")||0,n=x("stageRadius")||0,i=t.width+2*r,s=t.height+2*r,a=Math.min(n,i/2,s/2),l=Math.floor(Math.max(a,0)),c=i-2*l,d=s-2*l;return`M${e},0L0,0L0,${o}L${e},${o}L${e},0Z\n    M${t.x-r+l},${t.y-r} h${c} a${l},${l} 0 0 1 ${l},${l} v${d} a${l},${l} 0 0 1 -${l},${l} h-${c} a${l},${l} 0 0 1 -${l},-${l} v-${d} a${l},${l} 0 0 1 ${l},-${l} z`}function H(t){const{element:e}=t;let o="string"==typeof e?document.querySelector(e):e;o||(o=function(){const t=document.getElementById("driver-dummy-element");if(t)return t;let e=document.createElement("div");return e.id="driver-dummy-element",e.style.width="0",e.style.height="0",e.style.pointerEvents="none",e.style.opacity="0",e.style.position="fixed",e.style.top="50%",e.style.left="50%",document.body.appendChild(e),e}()),function(t,e){const o=Date.now(),r=P("__activeStep"),n=P("__activeElement")||t,i=!n||n===t,s="driver-dummy-element"===t.id,a="driver-dummy-element"===n.id,l=x("animate"),c=e.onHighlightStarted||x("onHighlightStarted"),d=(null==e?void 0:e.onHighlighted)||x("onHighlighted"),u=(null==r?void 0:r.onDeselected)||x("onDeselected"),p=x(),v=P();!i&&u&&u(a?void 0:n,r,{config:p,state:v}),c&&c(s?void 0:t,e,{config:p,state:v});const h=!i&&l;let f=!1;(function(){const t=P("popover");t&&(t.wrapper.style.display="none")})(),k("previousStep",r),k("previousElement",n),k("activeStep",e),k("activeElement",t);const m=()=>{if(P("__transitionCallback")!==m)return;const i=Date.now()-o,a=400-i<=200;e.popover&&a&&!f&&h&&(j(t,e),f=!0),x("animate")&&i<400?function(t,e,o,r){let n=P("__activeStagePosition");const i=n||o.getBoundingClientRect(),s=r.getBoundingClientRect();n={x:b(t,i.x,s.x-i.x,e),y:b(t,i.y,s.y-i.y,e),width:b(t,i.width,s.width-i.width,e),height:b(t,i.height,s.height-i.height,e)},M(n),k("__activeStagePosition",n)}(i,400,n,t):($(t),d&&d(s?void 0:t,e,{config:x(),state:P()}),k("__transitionCallback",void 0),k("__previousStep",r),k("__previousElement",n),k("__activeStep",e),k("__activeElement",t)),window.requestAnimationFrame(m)};k("__transitionCallback",m),window.requestAnimationFrame(m),L(t),!h&&e.popover&&j(t,e),n.classList.remove("driver-active-element","driver-no-interaction"),n.removeAttribute("aria-haspopup"),n.removeAttribute("aria-expanded"),n.removeAttribute("aria-controls"),x("disableActiveInteraction")&&t.classList.add("driver-no-interaction"),t.classList.add("driver-active-element"),t.setAttribute("aria-haspopup","dialog"),t.setAttribute("aria-expanded","true"),t.setAttribute("aria-controls","driver-popover-content")}(o,t)}function O(){const t=P("__activeElement"),e=P("__activeStep");t&&($(t),function(){const t=P("__activeStagePosition"),e=P("__overlaySvg");if(!t)return;if(!e)return void console.warn("No stage svg found.");const o=window.innerWidth,r=window.innerHeight;e.setAttribute("viewBox",`0 0 ${o} ${r}`)}(),q(t,e))}function N(){const t=P("__resizeTimeout");t&&window.cancelAnimationFrame(t),k("__resizeTimeout",window.requestAnimationFrame(O))}function I(t){var e;if(!P("isInitialized")||"Tab"!==t.key&&9!==t.keyCode)return;const o=P("__activeElement"),r=null==(e=P("popover"))?void 0:e.wrapper,n=_([...r?[r]:[],...o?[o]:[]]),i=n[0],s=n[n.length-1];if(t.preventDefault(),t.shiftKey){const t=n[n.indexOf(document.activeElement)-1]||s;null==t||t.focus()}else{const t=n[n.indexOf(document.activeElement)+1]||i;null==t||t.focus()}}function W(t){var e;(null==(e=x("allowKeyboardControl"))||e)&&("Escape"===t.key?A("escapePress"):"ArrowRight"===t.key?A("arrowRightPress"):"ArrowLeft"===t.key&&A("arrowLeftPress"))}function R(t,e,o){const r=(e,r)=>{const n=e.target;t.contains(n)&&((!o||o(n))&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()),null==r||r(e))};document.addEventListener("pointerdown",r,!0),document.addEventListener("mousedown",r,!0),document.addEventListener("pointerup",r,!0),document.addEventListener("mouseup",r,!0),document.addEventListener("click",(t=>{r(t,e)}),!0)}function j(t,e){var o,r;let n=P("popover");n&&document.body.removeChild(n.wrapper),n=function(){const t=document.createElement("div");t.classList.add("driver-popover");const e=document.createElement("div");e.classList.add("driver-popover-arrow");const o=document.createElement("header");o.id="driver-popover-title",o.classList.add("driver-popover-title"),o.style.display="none",o.innerText="Popover Title";const r=document.createElement("div");r.id="driver-popover-description",r.classList.add("driver-popover-description"),r.style.display="none",r.innerText="Popover description is here";const n=document.createElement("button");n.type="button",n.classList.add("driver-popover-close-btn"),n.setAttribute("aria-label","Close"),n.innerHTML="&times;";const i=document.createElement("footer");i.classList.add("driver-popover-footer");const s=document.createElement("span");s.classList.add("driver-popover-progress-text"),s.innerText="";const a=document.createElement("span");a.classList.add("driver-popover-navigation-btns");const l=document.createElement("button");l.type="button",l.classList.add("driver-popover-prev-btn"),l.innerHTML="&larr; Previous";const c=document.createElement("button");return c.type="button",c.classList.add("driver-popover-next-btn"),c.innerHTML="Next &rarr;",a.appendChild(l),a.appendChild(c),i.appendChild(s),i.appendChild(a),t.appendChild(n),t.appendChild(e),t.appendChild(o),t.appendChild(r),t.appendChild(i),{wrapper:t,arrow:e,title:o,description:r,footer:i,previousButton:l,nextButton:c,closeButton:n,footerButtons:a,progress:s}}(),document.body.appendChild(n.wrapper);const{title:i,description:s,showButtons:a,disableButtons:l,showProgress:c,nextBtnText:d=x("nextBtnText")||"Next &rarr;",prevBtnText:u=x("prevBtnText")||"&larr; Previous",progressText:p=x("progressText")||"{current} of {total}"}=e.popover||{};n.nextButton.innerHTML=d,n.previousButton.innerHTML=u,n.progress.innerHTML=p,i?(n.title.innerHTML=i,n.title.style.display="block"):n.title.style.display="none",s?(n.description.innerHTML=s,n.description.style.display="block"):n.description.style.display="none";const v=a||x("showButtons"),h=c||x("showProgress")||!1,f=(null==v?void 0:v.includes("next"))||(null==v?void 0:v.includes("previous"))||h;n.closeButton.style.display=v.includes("close")?"block":"none",f?(n.footer.style.display="flex",n.progress.style.display=h?"block":"none",n.nextButton.style.display=v.includes("next")?"block":"none",n.previousButton.style.display=v.includes("previous")?"block":"none"):n.footer.style.display="none";const m=l||x("disableButtons")||[];null!=m&&m.includes("next")&&(n.nextButton.disabled=!0,n.nextButton.classList.add("driver-popover-btn-disabled")),null!=m&&m.includes("previous")&&(n.previousButton.disabled=!0,n.previousButton.classList.add("driver-popover-btn-disabled")),null!=m&&m.includes("close")&&(n.closeButton.disabled=!0,n.closeButton.classList.add("driver-popover-btn-disabled"));const g=n.wrapper;g.style.display="block",g.style.left="",g.style.top="",g.style.bottom="",g.style.right="",g.id="driver-popover-content",g.setAttribute("role","dialog"),g.setAttribute("aria-labelledby","driver-popover-title"),g.setAttribute("aria-describedby","driver-popover-description"),n.arrow.className="driver-popover-arrow";const y=(null==(o=e.popover)?void 0:o.popoverClass)||x("popoverClass")||"";g.className=`driver-popover ${y}`.trim(),R(n.wrapper,(o=>{var r,n,i;const s=o.target,a=(null==(r=e.popover)?void 0:r.onNextClick)||x("onNextClick"),l=(null==(n=e.popover)?void 0:n.onPrevClick)||x("onPrevClick"),c=(null==(i=e.popover)?void 0:i.onCloseClick)||x("onCloseClick");return s.classList.contains("driver-popover-next-btn")?a?a(t,e,{config:x(),state:P()}):A("nextClick"):s.classList.contains("driver-popover-prev-btn")?l?l(t,e,{config:x(),state:P()}):A("prevClick"):s.classList.contains("driver-popover-close-btn")?c?c(t,e,{config:x(),state:P()}):A("closeClick"):void 0}),(t=>!(null!=n&&n.description.contains(t))&&!(null!=n&&n.title.contains(t))&&"string"==typeof t.className&&t.className.includes("driver-popover"))),k("popover",n);const w=(null==(r=e.popover)?void 0:r.onPopoverRender)||x("onPopoverRender");w&&w(n,{config:x(),state:P()}),q(t,e),L(g);const b=_([g,...t.classList.contains("driver-dummy-element")?[]:[t]]);b.length>0&&b[0].focus()}function G(){const t=P("popover");if(null==t||!t.wrapper)return;const e=t.wrapper.getBoundingClientRect(),o=x("stagePadding")||0,r=x("popoverOffset")||0;return{width:e.width+o+r,height:e.height+o+r,realWidth:e.width,realHeight:e.height}}function z(t,e){const{elementDimensions:o,popoverDimensions:r,popoverPadding:n,popoverArrowDimensions:i}=e;return"start"===t?Math.max(Math.min(o.top-n,window.innerHeight-r.realHeight-i.width),i.width):"end"===t?Math.max(Math.min(o.top-(null==r?void 0:r.realHeight)+o.height+n,window.innerHeight-(null==r?void 0:r.realHeight)-i.width),i.width):"center"===t?Math.max(Math.min(o.top+o.height/2-(null==r?void 0:r.realHeight)/2,window.innerHeight-(null==r?void 0:r.realHeight)-i.width),i.width):0}function F(t,e){const{elementDimensions:o,popoverDimensions:r,popoverPadding:n,popoverArrowDimensions:i}=e;return"start"===t?Math.max(Math.min(o.left-n,window.innerWidth-r.realWidth-i.width),i.width):"end"===t?Math.max(Math.min(o.left-(null==r?void 0:r.realWidth)+o.width+n,window.innerWidth-(null==r?void 0:r.realWidth)-i.width),i.width):"center"===t?Math.max(Math.min(o.left+o.width/2-(null==r?void 0:r.realWidth)/2,window.innerWidth-(null==r?void 0:r.realWidth)-i.width),i.width):0}function q(t,e){const o=P("popover");if(!o)return;const{align:r="start",side:n="left"}=(null==e?void 0:e.popover)||{},i=r,s="driver-dummy-element"===t.id?"over":n,a=x("stagePadding")||0,l=G(),c=o.arrow.getBoundingClientRect(),d=t.getBoundingClientRect(),u=d.top-l.height;let p=u>=0;const v=window.innerHeight-(d.bottom+l.height);let h=v>=0;const f=d.left-l.width;let m=f>=0;const g=window.innerWidth-(d.right+l.width);let y=g>=0;const w=!(p||h||m||y);let b=s;if("top"===s&&p?y=m=h=!1:"bottom"===s&&h?y=m=p=!1:"left"===s&&m?y=p=h=!1:"right"===s&&y&&(m=p=h=!1),"over"===s){const t=window.innerWidth/2-l.realWidth/2,e=window.innerHeight/2-l.realHeight/2;o.wrapper.style.left=`${t}px`,o.wrapper.style.right="auto",o.wrapper.style.top=`${e}px`,o.wrapper.style.bottom="auto"}else if(w){const t=window.innerWidth/2-(null==l?void 0:l.realWidth)/2,e=10;o.wrapper.style.left=`${t}px`,o.wrapper.style.right="auto",o.wrapper.style.bottom=`${e}px`,o.wrapper.style.top="auto"}else if(m){const t=Math.min(f,window.innerWidth-(null==l?void 0:l.realWidth)-c.width),e=z(i,{elementDimensions:d,popoverDimensions:l,popoverPadding:a,popoverArrowDimensions:c});o.wrapper.style.left=`${t}px`,o.wrapper.style.top=`${e}px`,o.wrapper.style.bottom="auto",o.wrapper.style.right="auto",b="left"}else if(y){const t=Math.min(g,window.innerWidth-(null==l?void 0:l.realWidth)-c.width),e=z(i,{elementDimensions:d,popoverDimensions:l,popoverPadding:a,popoverArrowDimensions:c});o.wrapper.style.right=`${t}px`,o.wrapper.style.top=`${e}px`,o.wrapper.style.bottom="auto",o.wrapper.style.left="auto",b="right"}else if(p){const t=Math.min(u,window.innerHeight-l.realHeight-c.width);let e=F(i,{elementDimensions:d,popoverDimensions:l,popoverPadding:a,popoverArrowDimensions:c});o.wrapper.style.top=`${t}px`,o.wrapper.style.left=`${e}px`,o.wrapper.style.bottom="auto",o.wrapper.style.right="auto",b="top"}else if(h){const t=Math.min(v,window.innerHeight-(null==l?void 0:l.realHeight)-c.width);let e=F(i,{elementDimensions:d,popoverDimensions:l,popoverPadding:a,popoverArrowDimensions:c});o.wrapper.style.left=`${e}px`,o.wrapper.style.bottom=`${t}px`,o.wrapper.style.top="auto",o.wrapper.style.right="auto",b="bottom"}w?o.arrow.classList.add("driver-popover-arrow-none"):function(t,e,o){const r=P("popover");if(!r)return;const n=o.getBoundingClientRect(),i=G(),s=r.arrow,a=i.width,l=window.innerWidth,c=n.width,d=n.left,u=i.height,p=window.innerHeight,v=n.top,h=n.height;s.className="driver-popover-arrow";let f=e,m=t;"top"===e?(d+c<=0?(f="right",m="end"):d+c-a<=0&&(f="top",m="start"),d>=l?(f="left",m="end"):d+a>=l&&(f="top",m="end")):"bottom"===e?(d+c<=0?(f="right",m="start"):d+c-a<=0&&(f="bottom",m="start"),d>=l?(f="left",m="start"):d+a>=l&&(f="bottom",m="end")):"left"===e?(v+h<=0?(f="bottom",m="end"):v+h-u<=0&&(f="left",m="start"),v>=p?(f="top",m="end"):v+u>=p&&(f="left",m="end")):"right"===e&&(v+h<=0?(f="bottom",m="start"):v+h-u<=0&&(f="right",m="start"),v>=p?(f="top",m="start"):v+u>=p&&(f="right",m="end")),f?(s.classList.add(`driver-popover-arrow-side-${f}`),s.classList.add(`driver-popover-arrow-align-${m}`)):s.classList.add("driver-popover-arrow-none")}(i,b,t)}function U(t={}){function e(){x("allowClose")&&l()}function o(){const t=P("activeIndex"),e=x("steps")||[];if(void 0===t)return;const o=t+1;e[o]?a(o):l()}function r(){const t=P("activeIndex"),e=x("steps")||[];if(void 0===t)return;const o=t-1;e[o]?a(o):l()}function n(){var t;if(P("__transitionCallback"))return;const e=P("activeIndex"),o=P("__activeStep"),n=P("__activeElement");if(void 0===e||void 0===o||void 0===P("activeIndex"))return;const i=(null==(t=o.popover)?void 0:t.onPrevClick)||x("onPrevClick");if(i)return i(n,o,{config:x(),state:P()});r()}function i(){var t;if(P("__transitionCallback"))return;const e=P("activeIndex"),r=P("__activeStep"),n=P("__activeElement");if(void 0===e||void 0===r)return;const i=(null==(t=r.popover)?void 0:t.onNextClick)||x("onNextClick");if(i)return i(n,r,{config:x(),state:P()});o()}function s(){P("isInitialized")||(k("isInitialized",!0),document.body.classList.add("driver-active",x("animate")?"driver-fade":"driver-simple"),window.addEventListener("keyup",W,!1),window.addEventListener("keydown",I,!1),window.addEventListener("resize",N),window.addEventListener("scroll",N),T("overlayClick",e),T("escapePress",e),T("arrowLeftPress",n),T("arrowRightPress",i))}function a(t=0){var e,o,r,n,i,s,c,d;const u=x("steps");if(!u)return console.error("No steps to drive through"),void l();if(!u[t])return void l();k("__activeOnDestroyed",document.activeElement),k("activeIndex",t);const p=u[t],v=u[t+1],h=u[t-1],f=(null==(e=p.popover)?void 0:e.doneBtnText)||x("doneBtnText")||"Done",m=x("allowClose"),g=void 0!==(null==(o=p.popover)?void 0:o.showProgress)?null==(r=p.popover)?void 0:r.showProgress:x("showProgress"),y=((null==(n=p.popover)?void 0:n.progressText)||x("progressText")||"{{current}} of {{total}}").replace("{{current}}",`${t+1}`).replace("{{total}}",`${u.length}`),w=(null==(i=p.popover)?void 0:i.showButtons)||x("showButtons"),b=["next","previous",...m?["close"]:[]].filter((t=>!(null!=w&&w.length)||w.includes(t))),_=(null==(s=p.popover)?void 0:s.onNextClick)||x("onNextClick"),L=(null==(c=p.popover)?void 0:c.onPrevClick)||x("onPrevClick"),C=(null==(d=p.popover)?void 0:d.onCloseClick)||x("onCloseClick");H({...p,popover:{showButtons:b,nextBtnText:v?void 0:f,disableButtons:[...h?[]:["previous"]],showProgress:g,progressText:y,onNextClick:_||(()=>{v?a(t+1):l()}),onPrevClick:L||(()=>{a(t-1)}),onCloseClick:C||(()=>{l()}),...(null==p?void 0:p.popover)||{}}})}function l(t=!0){const e=P("__activeElement"),o=P("__activeStep"),r=P("__activeOnDestroyed"),n=x("onDestroyStarted");if(t&&n)return void n(e&&"driver-dummy-element"!==(null==e?void 0:e.id)?e:void 0,o,{config:x(),state:P()});const i=(null==o?void 0:o.onDeselected)||x("onDeselected"),s=x("onDestroyed");if(document.body.classList.remove("driver-active","driver-fade","driver-simple"),window.removeEventListener("keyup",W),window.removeEventListener("resize",N),window.removeEventListener("scroll",N),function(){var t;const e=P("popover");e&&(null==(t=e.wrapper.parentElement)||t.removeChild(e.wrapper))}(),function(){var t;null==(t=document.getElementById("driver-dummy-element"))||t.remove(),document.querySelectorAll(".driver-active-element").forEach((t=>{t.classList.remove("driver-active-element","driver-no-interaction"),t.removeAttribute("aria-haspopup"),t.removeAttribute("aria-expanded"),t.removeAttribute("aria-controls")}))}(),function(){const t=P("__overlaySvg");t&&t.remove()}(),B={},S(),e&&o){const t="driver-dummy-element"===e.id;i&&i(t?void 0:e,o,{config:x(),state:P()}),s&&s(t?void 0:e,o,{config:x(),state:P()})}r&&r.focus()}return w(t),{isActive:()=>P("isInitialized")||!1,refresh:N,drive:(t=0)=>{s(),a(t)},setConfig:w,setSteps:t=>{S(),w({...x(),steps:t})},getConfig:x,getState:P,getActiveIndex:()=>P("activeIndex"),isFirstStep:()=>0===P("activeIndex"),isLastStep:()=>{const t=x("steps")||[],e=P("activeIndex");return void 0!==e&&e===t.length-1},getActiveStep:()=>P("activeStep"),getActiveElement:()=>P("activeElement"),getPreviousElement:()=>P("previousElement"),getPreviousStep:()=>P("previousStep"),moveNext:o,movePrevious:r,moveTo:function(t){(x("steps")||[])[t]?a(t):l()},hasNextStep:()=>{const t=x("steps")||[],e=P("activeIndex");return void 0!==e&&t[e+1]},hasPreviousStep:()=>{const t=x("steps")||[],e=P("activeIndex");return void 0!==e&&t[e-1]},highlight:t=>{s(),H({...t,popover:t.popover?{showButtons:[],showProgress:!1,progressText:"",...t.popover}:void 0})},destroy:()=>{l(!1)}}}const Y=flarum.core.compat["common/utils/extractText"];var K=o.n(Y);const V=flarum.core.compat["common/extend"],X=flarum.core.compat["forum/utils/UserControls"];var Z=o.n(X);const J=flarum.core.compat["common/components/Button"];var Q=o.n(J);g().initializers.add("datlechin/flarum-simple-tour-guide",(function(){(0,V.extend)(Z(),"userControls",(function(t,e){g().session.user.canResetTourGuide()&&e.attribute("tourGuideDismissedAt")&&t.add("reset-tour-guide",m(Q(),{icon:"fas fa-sync",onclick:function(){return function(t){confirm(K()(g().translator.trans("datlechin-simple-tour-guide.forum.user_controls.reset_tour_guide_confirmation")))&&t.save({tourGuideDismissedAt:null}).then((function(){return m.redraw()}))}(e)}},g().translator.trans("datlechin-simple-tour-guide.forum.user_controls.reset_tour_guide")))})),document.addEventListener("DOMContentLoaded",p(h().mark((function t(){var e,o,r,n,i,s;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=g().session.user)&&!e.tourGuideDismissedAt()){t.next=3;break}return t.abrupt("return");case 3:return o=[],t.next=6,g().store.find("tour-guide-steps").then((function(t){o=t}));case 6:r=function(){g().request({url:g().forum.attribute("apiUrl")+"/simple-tour-guide/dismiss",method:"POST"})},n=function(t,e){return void 0===e&&(e={}),K()(g().translator.trans("datlechin-simple-tour-guide.forum."+t,e))},s=function(){return o.map((function(t){return{element:t.target(),popover:{title:t.title(),description:t.description()},onDeselected:function(e){t.isTriggerClick()&&e.click()}}}))},U({showProgress:(i=function(t){return g().forum.attribute("datlechin-simple-tour-guide."+t)})("showProgress"),allowClose:i("allowClose"),smoothScroll:!0,overlayColor:"var(--overlay-bg)",progressText:n("progress_text",{current:"{{current}}",total:"{{total}}"}),showButtons:["next","previous"],nextBtnText:n("next_btn_text"),prevBtnText:n("prev_btn_text"),doneBtnText:n("done_btn_text"),steps:s(),onDestroyed:function(){r()}}).drive();case 12:case"end":return t.stop()}}),t)}))))}))})(),module.exports=r})();
//# sourceMappingURL=forum.js.map