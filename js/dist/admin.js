(()=>{var t={n:e=>{var i=e&&e.__esModule?()=>e.default:()=>e;return t.d(i,{a:i}),i},d:(e,i)=>{for(var r in i)t.o(i,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:i[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e),t.d(e,{extend:()=>c});const i=flarum.core.compat["common/extenders"];var r=t.n(i);function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,o(t,e)}const a=flarum.core.compat["common/Model"];var s=t.n(a),l=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var i=e.prototype;return i.title=function(){return s().attribute("title").call(this)},i.description=function(){return s().attribute("description").call(this)},i.target=function(){return s().attribute("target").call(this)},i.isTriggerClick=function(){return s().attribute("isTriggerClick").call(this)},e}(s());const d=flarum.core.compat["common/models/User"];var u=t.n(d);const c=[new(r().Model)(u()).attribute("tourGuideDismissedAt").attribute("canResetTourGuide"),(new(r().Store)).add("tour-guide-steps",l)],p=flarum.core.compat["admin/app"];var g=t.n(p);const h=flarum.core.compat["admin/components/ExtensionPage"];var f=t.n(h);const b=flarum.core.compat["common/components/Button"];var v=t.n(b);const _=flarum.core.compat["common/components/LoadingIndicator"];var y=t.n(_);const S=flarum.core.compat["common/components/Modal"];var T=t.n(S);const N=flarum.core.compat["common/utils/ItemList"];var w=t.n(N);const k=flarum.core.compat["common/utils/Stream"];var G=t.n(k);const C=flarum.core.compat["common/utils/extractText"];var F=t.n(C);const x=flarum.core.compat["common/components/Switch"];var M=t.n(x),P=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))||this).tourGuideStep=void 0,e.tourTitle=void 0,e.description=void 0,e.target=void 0,e.isTriggerClick=void 0,e}n(e,t);var i=e.prototype;return i.oninit=function(e){t.prototype.oninit.call(this,e),this.tourGuideStep=this.attrs.model||g().store.createRecord("tour-guide-steps"),this.tourTitle=G()(this.tourGuideStep.title()||""),this.description=G()(this.tourGuideStep.description()||""),this.target=G()(this.tourGuideStep.target()||""),this.isTriggerClick=G()(this.tourGuideStep.isTriggerClick()||!1)},i.className=function(){return"EditTourGuideStepModal Modal--small"},i.title=function(){return this.tourGuideStep.exists?g().translator.trans("datlechin-simple-tour-guide.admin.edit_modal.edit_step",{title:this.tourGuideStep.title()}):g().translator.trans("datlechin-simple-tour-guide.admin.edit_modal.create_step")},i.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form"},this.fields().toArray()))},i.fields=function(){var t=this,e=new(w());return e.add("title",m("div",{className:"Form-group"},m("label",null,g().translator.trans("datlechin-simple-tour-guide.admin.title")),m("input",{className:"FormControl",disabled:this.loading,bidi:this.tourTitle,placeholder:g().translator.trans("datlechin-simple-tour-guide.admin.title_placeholder")})),30),e.add("description",m("div",{className:"Form-group"},m("label",null,g().translator.trans("datlechin-simple-tour-guide.admin.description")),m("textarea",{className:"FormControl",disabled:this.loading,bidi:this.description,rows:"3",placeholder:g().translator.trans("datlechin-simple-tour-guide.admin.description_placeholder")})),20),e.add("target",m("div",{className:"Form-group"},m("label",null,g().translator.trans("datlechin-simple-tour-guide.admin.target")),m("input",{className:"FormControl",disabled:this.loading,bidi:this.target,placeholder:g().translator.trans("datlechin-simple-tour-guide.admin.target_placeholder")})),10),e.add("isTriggerClick",m("div",{className:"Form-group"},m(M(),{onchange:this.isTriggerClick,state:this.isTriggerClick(),loading:this.loading},g().translator.trans("datlechin-simple-tour-guide.admin.trigger_click")))),e.add("submit",m("div",{className:"Form-group"},m(v(),{type:"submit",className:"Button Button--primary EditTagModal-save",loading:this.loading},"Submit"),this.tourGuideStep.exists&&m("button",{type:"button",className:"Button EditTagModal-delete",onclick:function(){return t.delete()}},g().translator.trans("datlechin-simple-tour-guide.admin.edit_modal.delete_step"))),0),e},i.submitData=function(){return{title:this.tourTitle(),description:this.description(),target:this.target(),is_trigger_click:this.isTriggerClick()}},i.onsubmit=function(t){var e=this;t.preventDefault(),this.loading=!0,this.tourGuideStep.save(this.submitData()).then((function(){return e.hide()}),(function(){return e.loading=!1}))},i.delete=function(){confirm(F()(g().translator.trans("datlechin-simple-tour-guide.admin.edit_modal.delete_step_confirmation")))&&(this.tourGuideStep.delete().then((function(){return m.redraw()})),this.hide())},e}(T()),O=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var i=e.prototype;return i.oninit=function(e){var i=this;t.prototype.oninit.call(this,e),this.loading=!0,g().store.find("tour-guide-steps").then((function(t){g().store.pushPayload(t.payload),i.loading=!1,m.redraw()}))},i.content=function(){var t=g().store.all("tour-guide-steps");return m("div",{className:"ExtensionPage-settings"},m("div",{className:"container"},m("div",{className:"Form"},this.buildSettingComponent({setting:"datlechin-simple-tour-guide.show_progress",type:"boolean",label:g().translator.trans("datlechin-simple-tour-guide.admin.settings.show_progress_label"),help:g().translator.trans("datlechin-simple-tour-guide.admin.settings.show_progress_help")}),this.buildSettingComponent({setting:"datlechin-simple-tour-guide.allow_close",type:"boolean",label:g().translator.trans("datlechin-simple-tour-guide.admin.settings.allow_close_label"),help:g().translator.trans("datlechin-simple-tour-guide.admin.settings.allow_close_help")}),m("div",{className:"Form-group"},m(v(),{className:"Button",icon:"fas fa-plus",onclick:function(){return g().modal.show(P)}},g().translator.trans("datlechin-simple-tour-guide.admin.add_step"))),this.loading?m(y(),null):m("[",null,t.length>0&&m("table",{className:"TourGuideSteps-Table"},m("thead",null,m("tr",null,m("th",null,g().translator.trans("datlechin-simple-tour-guide.admin.title")),m("th",null,g().translator.trans("datlechin-simple-tour-guide.admin.target")),m("th",null,g().translator.trans("datlechin-simple-tour-guide.admin.trigger_click")))),m("tbody",null,t.map((function(t){return m("tr",null,m("td",null,t.title()),m("td",null,t.target(),m(v(),{className:"Button Button--icon",icon:"fas fa-edit",onclick:function(){return g().modal.show(P,{model:t})}})),m("td",null,t.isTriggerClick()?g().translator.trans("datlechin-simple-tour-guide.admin.yes"):g().translator.trans("datlechin-simple-tour-guide.admin.no")))}))))),m("div",{className:"Form-group"},this.submitButton()))))},e}(f());g().initializers.add("datlechin/flarum-simple-tour-guide",(function(){g().extensionData.for("datlechin-simple-tour-guide").registerPage(O).registerPermission({icon:"fas fa-sync",label:g().translator.trans("datlechin-simple-tour-guide.admin.permissions.reset_tour_guide"),permission:"resetTourGuide"},"moderate")}))})(),module.exports=e})();
//# sourceMappingURL=admin.js.map