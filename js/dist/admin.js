(()=>{var t={n:e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return t.d(o,{a:o}),o},d:(e,o)=>{for(var i in o)t.o(o,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:o[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e),t.d(e,{extend:()=>u});const o=flarum.core.compat["common/extenders"];var i=t.n(o);function n(t,e){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},n(t,e)}function r(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,n(t,e)}const a=flarum.core.compat["common/Model"];var l=t.n(a),s=function(t){function e(){return t.apply(this,arguments)||this}r(e,t);var o=e.prototype;return o.title=function(){return l().attribute("title").call(this)},o.description=function(){return l().attribute("description").call(this)},o.target=function(){return l().attribute("target").call(this)},e}(l());const u=[(new(i().Store)).add("tour-guide-steps",s)],d=flarum.core.compat["admin/app"];var c=t.n(d);const p=flarum.core.compat["admin/components/ExtensionPage"];var h=t.n(p);const g=flarum.core.compat["common/components/Button"];var f=t.n(g);const b=flarum.core.compat["common/components/LoadingIndicator"];var v=t.n(b);const y=flarum.core.compat["common/components/Modal"];var _=t.n(y);const S=flarum.core.compat["common/utils/ItemList"];var N=t.n(S);const w=flarum.core.compat["common/utils/Stream"];var G=t.n(w);const T=flarum.core.compat["common/utils/extractText"];var x=t.n(T),F=function(t){function e(){for(var e,o=arguments.length,i=new Array(o),n=0;n<o;n++)i[n]=arguments[n];return(e=t.call.apply(t,[this].concat(i))||this).tourGuideStep=void 0,e.tourTitle=void 0,e.description=void 0,e.target=void 0,e}r(e,t);var o=e.prototype;return o.oninit=function(e){t.prototype.oninit.call(this,e),this.tourGuideStep=this.attrs.model||c().store.createRecord("tour-guide-steps"),this.tourTitle=G()(this.tourGuideStep.title()||""),this.description=G()(this.tourGuideStep.description()||""),this.target=G()(this.tourGuideStep.target()||"")},o.className=function(){return"EditTourGuideStepModal Modal--small"},o.title=function(){return this.tourGuideStep.exists?c().translator.trans("datlechin-simple-tour-guide.admin.edit_modal.edit_step",{title:this.tourGuideStep.title()}):c().translator.trans("datlechin-simple-tour-guide.admin.edit_modal.create_step")},o.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form"},this.fields().toArray()))},o.fields=function(){var t=this,e=new(N());return e.add("title",m("div",{className:"Form-group"},m("label",null,c().translator.trans("datlechin-simple-tour-guide.admin.title")),m("input",{className:"FormControl",disabled:this.loading,bidi:this.tourTitle,placeholder:c().translator.trans("datlechin-simple-tour-guide.admin.title_placeholder")})),30),e.add("description",m("div",{className:"Form-group"},m("label",null,c().translator.trans("datlechin-simple-tour-guide.admin.description")),m("textarea",{className:"FormControl",disabled:this.loading,bidi:this.description,rows:"3",placeholder:c().translator.trans("datlechin-simple-tour-guide.admin.description_placeholder")})),20),e.add("target",m("div",{className:"Form-group"},m("label",null,c().translator.trans("datlechin-simple-tour-guide.admin.target")),m("input",{className:"FormControl",disabled:this.loading,bidi:this.target,placeholder:c().translator.trans("datlechin-simple-tour-guide.admin.target_placeholder")})),10),e.add("submit",m("div",{className:"Form-group"},m(f(),{type:"submit",className:"Button Button--primary EditTagModal-save",loading:this.loading},"Submit"),this.tourGuideStep.exists&&m("button",{type:"button",className:"Button EditTagModal-delete",onclick:function(){return t.delete()}},c().translator.trans("datlechin-simple-tour-guide.admin.edit_modal.delete_step"))),0),e},o.submitData=function(){return{title:this.tourTitle(),description:this.description(),target:this.target()}},o.onsubmit=function(t){var e=this;t.preventDefault(),this.loading=!0,this.tourGuideStep.save(this.submitData()).then((function(){return e.hide()}),(function(){return e.loading=!1}))},o.delete=function(){confirm(x()(c().translator.trans("datlechin-simple-tour-guide.admin.edit_modal.delete_step_confirmation")))&&(this.tourGuideStep.delete().then((function(){return m.redraw()})),this.hide())},e}(_()),M=function(t){function e(){return t.apply(this,arguments)||this}r(e,t);var o=e.prototype;return o.oninit=function(e){var o=this;t.prototype.oninit.call(this,e),this.loading=!0,c().store.find("tour-guide-steps").then((function(t){c().store.pushPayload(t.payload),o.loading=!1,m.redraw()}))},o.content=function(){var t=c().store.all("tour-guide-steps");return m("div",{className:"ExtensionPage-settings"},m("div",{className:"container"},m("div",{className:"Form"},this.buildSettingComponent({setting:"datlechin-simple-tour-guide.show_progress",type:"boolean",label:c().translator.trans("datlechin-simple-tour-guide.admin.settings.show_progress_label"),help:c().translator.trans("datlechin-simple-tour-guide.admin.settings.show_progress_help")}),this.buildSettingComponent({setting:"datlechin-simple-tour-guide.allow_close",type:"boolean",label:c().translator.trans("datlechin-simple-tour-guide.admin.settings.allow_close_label"),help:c().translator.trans("datlechin-simple-tour-guide.admin.settings.allow_close_help")}),m("div",{className:"Form-group"},m(f(),{className:"Button",icon:"fas fa-plus",onclick:function(){return c().modal.show(F)}},"Create new tour")),this.loading?m(v(),null):m("[",null,t.length>0&&m("table",{className:"TourGuideSteps-Table"},m("thead",null,m("tr",null,m("th",null,c().translator.trans("datlechin-simple-tour-guide.admin.title")),m("th",null,c().translator.trans("datlechin-simple-tour-guide.admin.target")))),m("tbody",null,t.map((function(t){return m("tr",null,m("td",null,t.title()),m("td",null,t.target(),m(f(),{className:"Button Button--icon",icon:"fas fa-edit",onclick:function(){return c().modal.show(F,{model:t})}})))}))))),m("div",{className:"Form-group"},this.submitButton()))))},e}(h());c().initializers.add("datlechin/flarum-simple-tour-guide",(function(){c().extensionData.for("datlechin-simple-tour-guide").registerPage(M)}))})(),module.exports=e})();
//# sourceMappingURL=admin.js.map